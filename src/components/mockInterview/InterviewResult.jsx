import React from 'react';
import { X, FileText, CheckCircle, Play, Brain, Download, Clock, Eye, Mic, BarChart3, TrendingUp, Database } from 'lucide-react';

const InterviewResult = ({ 
  questions, 
  answers, 
  onClose, 
  onRestart,
  onStartAIAnalysis,
  hasRecording = false,
  recordingDuration = 0,
  hasRealTimeAnalysis = false,
  // üéØ Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞ Ï∂îÍ∞Ä
  realTimeAnalysisData = null
}) => {
  
  // ÏãúÍ∞Ñ Ìè¨Îß∑ÌåÖ Ìï®Ïàò
  const formatDuration = (seconds) => {
    const mins = Math.floor(seconds / 60);
    const secs = seconds % 60;
    return `${mins}Î∂Ñ ${secs}Ï¥à`;
  };

  // ÎãµÎ≥Ä ÌÜµÍ≥Ñ Í≥ÑÏÇ∞
  const calculateAnswerStats = (answer) => {
    if (!answer) return { length: 0, estimatedTime: 0, wordCount: 0 };
    
    const length = answer.length;
    const wordCount = answer.split(/\s+/).filter(word => word.length > 0).length;
    const estimatedTime = Math.ceil(wordCount / 150); // Î∂ÑÎãπ 150Îã®Ïñ¥ Í∏∞Ï§Ä
    
    return { length, estimatedTime, wordCount };
  };

  // Ï†ÑÏ≤¥ Î©¥Ï†ë ÌÜµÍ≥Ñ
  const totalStats = (answers || []).reduce((acc, answer) => {
    const stats = calculateAnswerStats(answer);
    return {
      totalChars: acc.totalChars + stats.length,
      totalWords: acc.totalWords + stats.wordCount,
      totalEstimatedTime: acc.totalEstimatedTime + stats.estimatedTime
    };
  }, { totalChars: 0, totalWords: 0, totalEstimatedTime: 0 });

  // üéØ Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù ÎØ∏Î¶¨Î≥¥Í∏∞ Ï†êÏàò Í≥ÑÏÇ∞
  const calculatePreviewScore = () => {
    if (!realTimeAnalysisData) return 0;
    
    const { audio, video } = realTimeAnalysisData;
    let score = 65;
    
    // ÏùåÏÑ± Ï†êÏàò
    if (audio?.currentVolume >= 20 && audio?.currentVolume <= 80) score += 8;
    if (audio?.wordsPerMinute >= 100 && audio?.wordsPerMinute <= 200) score += 5;
    if (audio?.speakingTime > 30) score += 5;
    
    // ÏòÅÏÉÅ Ï†êÏàò
    if (video?.faceDetected) score += 5;
    if (video?.eyeContactPercentage >= 50) score += 10;
    else if (video?.eyeContactPercentage >= 30) score += 5;
    if (video?.smileDetection >= 25) score += 5;
    if (video?.postureScore >= 70) score += 3;
    
    return Math.max(30, Math.min(95, score));
  };

  // üéØ Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞Î•º ÏÉà Ï∞ΩÏúºÎ°ú Ïó¨Îäî Ìï®Ïàò
  const openDeveloperDataWindow = () => {
    const developerData = {
      sessionInfo: {
        timestamp: new Date().toISOString(),
        sessionId: `interview_${Date.now()}`,
        totalDuration: recordingDuration || 0,
        questionsCount: questions?.length || 0,
        answersCount: answers?.filter(a => a && a.trim()).length || 0,
        completionRate: questions?.length ? (answers?.filter(a => a && a.trim()).length / questions.length * 100).toFixed(1) : 0,
        hasRecording,
        hasRealTimeAnalysis,
        previewScore: calculatePreviewScore()
      },
      
      // Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù Raw Îç∞Ïù¥ÌÑ∞
      realTimeAnalysisData: realTimeAnalysisData || {},
      
      // Î©¥Ï†ë ÎÇ¥Ïö©
      interviewContent: {
        questions: questions || [],
        answers: answers || [],
        questionAnswerPairs: questions?.map((q, i) => ({
          questionIndex: i,
          question: q,
          answer: answers[i] || '',
          answerLength: answers[i]?.length || 0,
          wordCount: answers[i] ? answers[i].split(/\s+/).filter(w => w.length > 0).length : 0,
          completed: !!(answers[i] && answers[i].trim())
        })) || []
      },
      
      // Í≥ÑÏÇ∞Îêú Î©îÌä∏Î¶≠Ïä§
      calculatedMetrics: {
        averageAnswerLength: (answers && answers.length) ? 
          (answers || []).reduce((sum, a) => sum + (a?.length || 0), 0) / answers.length : 0,
        totalWords: (answers || []).reduce((sum, a) => 
          sum + (a ? a.split(/\s+/).filter(w => w.length > 0).length : 0), 0) || 0,
        averageWordsPerAnswer: (answers && answers.length) ? 
          ((answers || []).reduce((sum, a) => 
            sum + (a ? a.split(/\s+/).filter(w => w.length > 0).length : 0), 0) / answers.length) : 0,
        speakingTimePercentage: realTimeAnalysisData?.audio?.speakingTime && recordingDuration ? 
          (realTimeAnalysisData.audio.speakingTime / recordingDuration * 100).toFixed(1) : 0,
        completionRate: (questions && questions.length) ? ((answers || []).filter(a => a && a.trim()).length / questions.length * 100).toFixed(1) : 0
      },

      // ÏÑ±Îä• Î∞è Í∏∞Ïà† Ï†ïÎ≥¥
      technicalInfo: {
        userAgent: navigator.userAgent,
        platform: navigator.platform,
        language: navigator.language,
        screenResolution: `${screen.width}x${screen.height}`,
        viewportSize: `${window.innerWidth}x${window.innerHeight}`,
        timestamp: new Date().toISOString(),
        timeZone: Intl.DateTimeFormat().resolvedOptions().timeZone
      }
    };

    // ÏÉà Ï∞ΩÏúºÎ°ú Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞ ÌëúÏãú
    const newWindow = window.open('', '_blank', 'width=1400,height=900,scrollbars=yes,resizable=yes');
    if (newWindow) {
      newWindow.document.write(`
        <!DOCTYPE html>
        <html lang="ko">
        <head>
          <meta charset="UTF-8">
          <meta name="viewport" content="width=device-width, initial-scale=1.0">
          <title>üî¨ Î©¥Ï†ë Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞ - ${developerData.sessionInfo.sessionId}</title>
          <style>
            * { margin: 0; padding: 0; box-sizing: border-box; }
            body { 
              font-family: 'SF Mono', 'Monaco', 'Inconsolata', 'Roboto Mono', monospace;
              background: linear-gradient(135deg, #1f2937 0%, #111827 100%);
              color: #f9fafb;
              padding: 20px;
              line-height: 1.6;
            }
            .container { max-width: 1200px; margin: 0 auto; }
            h1 { 
              color: #60a5fa; 
              font-size: 24px; 
              margin-bottom: 20px; 
              padding-bottom: 10px;
              border-bottom: 2px solid #374151;
            }
            h2 { 
              color: #34d399; 
              font-size: 18px; 
              margin: 30px 0 15px 0;
              padding: 10px;
              background: rgba(16, 185, 129, 0.1);
              border-left: 4px solid #10b981;
            }
            .metrics-grid {
              display: grid;
              grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
              gap: 15px;
              margin: 20px 0;
            }
            .metric-card {
              background: rgba(55, 65, 81, 0.5);
              padding: 15px;
              border-radius: 8px;
              border: 1px solid #374151;
            }
            .metric-label { 
              font-size: 12px; 
              color: #9ca3af; 
              margin-bottom: 5px; 
            }
            .metric-value { 
              font-size: 20px; 
              font-weight: bold; 
              color: #60a5fa; 
            }
            .action-buttons {
              position: sticky;
              top: 0;
              background: rgba(31, 41, 55, 0.95);
              padding: 15px 0;
              margin-bottom: 20px;
              border-bottom: 1px solid #374151;
              backdrop-filter: blur(10px);
              z-index: 100;
            }
            .btn {
              padding: 8px 16px;
              margin-right: 10px;
              background: #3b82f6;
              color: white;
              border: none;
              border-radius: 6px;
              cursor: pointer;
              font-size: 14px;
              font-weight: 500;
              transition: all 0.2s;
            }
            .btn:hover { background: #2563eb; transform: translateY(-1px); }
            .btn.success { background: #10b981; }
            .btn.success:hover { background: #059669; }
            .btn.warning { background: #f59e0b; }
            .btn.warning:hover { background: #d97706; }
            pre {
              background: rgba(0, 0, 0, 0.3);
              padding: 20px;
              border-radius: 8px;
              white-space: pre-wrap;
              word-wrap: break-word;
              font-size: 12px;
              line-height: 1.4;
              border: 1px solid #374151;
              max-height: 400px;
              overflow-y: auto;
            }
            .section {
              background: rgba(55, 65, 81, 0.3);
              margin: 20px 0;
              border-radius: 12px;
              border: 1px solid #374151;
              overflow: hidden;
            }
            .section-header {
              background: rgba(59, 130, 246, 0.1);
              padding: 15px 20px;
              border-bottom: 1px solid #374151;
              display: flex;
              justify-content: space-between;
              align-items: center;
            }
            .status-good { color: #10b981; }
            .status-warning { color: #f59e0b; }
            .status-error { color: #ef4444; }
            .footer {
              margin-top: 40px;
              padding: 20px;
              background: rgba(55, 65, 81, 0.3);
              border-radius: 8px;
              text-align: center;
              font-size: 12px;
              color: #9ca3af;
              border: 1px solid #374151;
            }
          </style>
        </head>
        <body>
          <div class="container">
            <h1>üî¨ Î©¥Ï†ë Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞ Î∂ÑÏÑù</h1>
            
            <div class="action-buttons">
              <button class="btn success" onclick="copyAllData()">üìã Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞ Î≥µÏÇ¨</button>
              <button class="btn warning" onclick="downloadJSON()">üíæ JSON Îã§Ïö¥Î°úÎìú</button>
              <button class="btn" onclick="window.print()">üñ®Ô∏è Ïù∏ÏáÑ</button>
              <span style="margin-left: 20px; color: #9ca3af; font-size: 12px;">
                ÏÉùÏÑ± ÏãúÍ∞Ñ: ${new Date().toLocaleString('ko-KR')}
              </span>
            </div>

            <!-- ÌïµÏã¨ Î©îÌä∏Î¶≠Ïä§ -->
            <h2>üìä ÌïµÏã¨ Î©îÌä∏Î¶≠Ïä§</h2>
            <div class="metrics-grid">
              <div class="metric-card">
                <div class="metric-label">ÏôÑÎ£åÏú®</div>
                <div class="metric-value">${developerData.calculatedMetrics.completionRate}%</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">Ï¥ù Îã®Ïñ¥ Ïàò</div>
                <div class="metric-value">${developerData.calculatedMetrics.totalWords}</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">ÌèâÍ∑† ÎãµÎ≥Ä Í∏∏Ïù¥</div>
                <div class="metric-value">${Math.round(developerData.calculatedMetrics.averageAnswerLength)}Ïûê</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">ÎßêÌïòÍ∏∞ ÎπÑÏú®</div>
                <div class="metric-value">${developerData.calculatedMetrics.speakingTimePercentage}%</div>
              </div>
              <div class="metric-card">
                <div class="metric-label">ÏòàÏÉÅ Ï†êÏàò</div>
                <div class="metric-value">${developerData.sessionInfo.previewScore}Ï†ê</div>
              </div>
            </div>

            <!-- ÏÑ∏ÏÖò Ï†ïÎ≥¥ -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">üóÇÔ∏è ÏÑ∏ÏÖò Ï†ïÎ≥¥</h2>
                <button class="btn" onclick="copySection('sessionInfo')">Î≥µÏÇ¨</button>
              </div>
              <pre id="sessionInfo">${JSON.stringify(developerData.sessionInfo, null, 2)}</pre>
            </div>

            <!-- Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞ -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">üìà Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù Îç∞Ïù¥ÌÑ∞</h2>
                <button class="btn" onclick="copySection('realTimeData')">Î≥µÏÇ¨</button>
              </div>
              <pre id="realTimeData">${JSON.stringify(developerData.realTimeAnalysisData, null, 2)}</pre>
            </div>

            <!-- Î©¥Ï†ë ÎÇ¥Ïö© -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">üí¨ Î©¥Ï†ë ÎÇ¥Ïö©</h2>
                <button class="btn" onclick="copySection('interviewContent')">Î≥µÏÇ¨</button>
              </div>
              <pre id="interviewContent">${JSON.stringify(developerData.interviewContent, null, 2)}</pre>
            </div>

            <!-- Í≥ÑÏÇ∞Îêú Î©îÌä∏Î¶≠Ïä§ -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">üßÆ Í≥ÑÏÇ∞Îêú Î©îÌä∏Î¶≠Ïä§</h2>
                <button class="btn" onclick="copySection('calculatedMetrics')">Î≥µÏÇ¨</button>
              </div>
              <pre id="calculatedMetrics">${JSON.stringify(developerData.calculatedMetrics, null, 2)}</pre>
            </div>

            <!-- Í∏∞Ïà† Ï†ïÎ≥¥ -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">‚öôÔ∏è Í∏∞Ïà† Ï†ïÎ≥¥</h2>
                <button class="btn" onclick="copySection('technicalInfo')">Î≥µÏÇ¨</button>
              </div>
              <pre id="technicalInfo">${JSON.stringify(developerData.technicalInfo, null, 2)}</pre>
            </div>

            <!-- Ï†ÑÏ≤¥ Raw Îç∞Ïù¥ÌÑ∞ -->
            <div class="section">
              <div class="section-header">
                <h2 style="margin: 0;">üîç Ï†ÑÏ≤¥ Raw Îç∞Ïù¥ÌÑ∞</h2>
                <button class="btn" onclick="copySection('allData')">Î≥µÏÇ¨</button>
              </div>
              <pre id="allData">${JSON.stringify(developerData, null, 2)}</pre>
            </div>

            <div class="footer">
              <p>üîí <strong>Í∞úÏù∏Ï†ïÎ≥¥ Î≥¥Ìò∏:</strong> Î™®Îì† Îç∞Ïù¥ÌÑ∞Îäî Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú Ï≤òÎ¶¨ÎêòÏóàÏúºÎ©∞ Ïô∏Î∂ÄÎ°ú Ï†ÑÏÜ°ÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.</p>
              <p>ÏÑ∏ÏÖò ID: ${developerData.sessionInfo.sessionId}</p>
            </div>
          </div>

          <script>
            const fullData = ${JSON.stringify(developerData, null, 2)};

            function copyAllData() {
              navigator.clipboard.writeText(JSON.stringify(${JSON.stringify(developerData)}, null, 2))
                .then(() => alert('‚úÖ Ï†ÑÏ≤¥ Îç∞Ïù¥ÌÑ∞Í∞Ä ÌÅ¥Î¶ΩÎ≥¥ÎìúÏóê Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!'))
                .catch(err => alert('‚ùå Î≥µÏÇ¨ Ïã§Ìå®: ' + err));
            }

            function copySection(sectionId) {
              const element = document.getElementById(sectionId);
              if (element) {
                navigator.clipboard.writeText(element.textContent)
                  .then(() => alert('‚úÖ ' + sectionId + ' Îç∞Ïù¥ÌÑ∞Í∞Ä Î≥µÏÇ¨ÎêòÏóàÏäµÎãàÎã§!'))
                  .catch(err => alert('‚ùå Î≥µÏÇ¨ Ïã§Ìå®: ' + err));
              }
            }

            function downloadJSON() {
              const blob = new Blob([JSON.stringify(${JSON.stringify(developerData)}, null, 2)], 
                { type: 'application/json' });
              const url = URL.createObjectURL(blob);
              const a = document.createElement('a');
              a.href = url;
              a.download = '${developerData.sessionInfo.sessionId}_developer_data.json';
              document.body.appendChild(a);
              a.click();
              document.body.removeChild(a);
              URL.revokeObjectURL(url);
              alert('‚úÖ JSON ÌååÏùºÏù¥ Îã§Ïö¥Î°úÎìúÎêòÏóàÏäµÎãàÎã§!');
            }

            // ÌÇ§Î≥¥Îìú Îã®Ï∂ïÌÇ§
            document.addEventListener('keydown', function(e) {
              if (e.ctrlKey || e.metaKey) {
                switch(e.key) {
                  case 's':
                    e.preventDefault();
                    downloadJSON();
                    break;
                  case 'a':
                    e.preventDefault();
                    copyAllData();
                    break;
                }
              }
            });
          </script>
        </body>
        </html>
      `);
      
      // ÏÉà Ï∞Ω Ìè¨Ïª§Ïä§
      newWindow.focus();
    } else {
      alert('ÌåùÏóÖÏù¥ Ï∞®Îã®ÎêòÏóàÏäµÎãàÎã§. ÌåùÏóÖ Ï∞®Îã®ÏùÑ Ìï¥Ï†úÌï¥Ï£ºÏÑ∏Ïöî.');
    }
  };

  const previewScore = calculatePreviewScore();

  return (
    <div style={{ minHeight: '100vh', backgroundColor: '#f3f4f6', padding: '24px' }}>
      <div style={{ maxWidth: '800px', margin: '0 auto' }}>
        
        {/* ÏôÑÎ£å Ìó§Îçî */}
        <div style={{ 
          backgroundColor: 'white', 
          borderRadius: '12px', 
          boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
          padding: '32px',
          marginBottom: '24px',
          textAlign: 'center'
        }}>
          <div style={{ 
            width: '80px', 
            height: '80px', 
            backgroundColor: '#10b981', 
            borderRadius: '50%', 
            display: 'flex', 
            alignItems: 'center', 
            justifyContent: 'center',
            margin: '0 auto 16px'
          }}>
            <CheckCircle size={40} style={{ color: 'white' }} />
          </div>
          <h1 style={{ 
            fontSize: '28px', 
            fontWeight: '700', 
            color: '#1f2937', 
            marginBottom: '8px' 
          }}>
            üéâ Î©¥Ï†ëÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§!
          </h1>
          <p style={{ color: '#6b7280', fontSize: '16px', margin: '0 0 16px 0' }}>
            Ï¥ù {(questions || []).length}Í∞úÏùò ÏßàÎ¨∏Ïóê ÎåÄÌïú ÎãµÎ≥ÄÏù¥ Í∏∞Î°ùÎêòÏóàÏäµÎãàÎã§.
          </p>
          
          {/* Î©¥Ï†ë ÌÜµÍ≥Ñ ÏöîÏïΩ */}
          <div style={{ 
            display: 'grid', 
            gridTemplateColumns: 'repeat(auto-fit, minmax(150px, 1fr))', 
            gap: '16px',
            marginTop: '16px',
            padding: '16px',
            backgroundColor: '#f9fafb',
            borderRadius: '8px'
          }}>
            <div style={{ textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: '700', color: '#3b82f6' }}>
                {totalStats.totalWords}
              </div>
              <div style={{ fontSize: '12px', color: '#6b7280' }}>Ï¥ù Îã®Ïñ¥ Ïàò</div>
            </div>
            <div style={{ textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: '700', color: '#10b981' }}>
                {totalStats.totalChars}
              </div>
              <div style={{ fontSize: '12px', color: '#6b7280' }}>Ï¥ù Í∏ÄÏûê Ïàò</div>
            </div>
            <div style={{ textAlign: 'center' }}>
              <div style={{ fontSize: '24px', fontWeight: '700', color: '#f59e0b' }}>
                {totalStats.totalEstimatedTime}Î∂Ñ
              </div>
              <div style={{ fontSize: '12px', color: '#6b7280' }}>ÏòàÏÉÅ ÎãµÎ≥ÄÏãúÍ∞Ñ</div>
            </div>
            {hasRecording && (
              <div style={{ textAlign: 'center' }}>
                <div style={{ fontSize: '24px', fontWeight: '700', color: '#8b5cf6' }}>
                  {formatDuration(recordingDuration)}
                </div>
                <div style={{ fontSize: '12px', color: '#6b7280' }}>Ïã§Ï†ú ÎÖπÌôîÏãúÍ∞Ñ</div>
              </div>
            )}
          </div>
        </div>

        {/* üéØ Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù ÎØ∏Î¶¨Î≥¥Í∏∞ (Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑùÏù¥ ÏûàÎäî Í≤ΩÏö∞) */}
        {hasRealTimeAnalysis && realTimeAnalysisData && (
          <div style={{ 
            backgroundColor: 'white', 
            borderRadius: '12px', 
            boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
            padding: '24px',
            marginBottom: '24px',
            border: '2px solid #10b981'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px' }}>
              <BarChart3 size={32} style={{ color: '#10b981', marginRight: '12px' }} />
              <div>
                <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#1f2937', margin: 0 }}>
                  üìä Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù ÎØ∏Î¶¨Î≥¥Í∏∞
                </h3>
                <p style={{ color: '#6b7280', fontSize: '14px', margin: '4px 0 0 0' }}>
                  Î©¥Ï†ë Ï§ë Ïã§ÏãúÍ∞ÑÏúºÎ°ú ÏàòÏßëÎêú Îç∞Ïù¥ÌÑ∞ Í∏∞Î∞ò ÏòàÏÉÅ Ï†êÏàò
                </p>
              </div>
            </div>
            
            {/* ÎØ∏Î¶¨Î≥¥Í∏∞ Ï†êÏàò */}
            <div style={{
              display: 'flex',
              alignItems: 'center',
              gap: '24px',
              padding: '20px',
              backgroundColor: '#f0fdf4',
              borderRadius: '12px',
              marginBottom: '20px',
              border: '1px solid #bbf7d0'
            }}>
              <div style={{
                display: 'flex',
                flexDirection: 'column',
                alignItems: 'center',
                justifyContent: 'center',
                width: '80px',
                height: '80px',
                background: 'linear-gradient(135deg, #10b981, #059669)',
                borderRadius: '50%',
                color: 'white',
                fontWeight: '700'
              }}>
                <span style={{ fontSize: '24px', lineHeight: '1' }}>{previewScore}</span>
                <span style={{ fontSize: '12px', opacity: '0.9' }}>Ï†ê</span>
              </div>
              
              <div style={{ flex: 1 }}>
                <h4 style={{ margin: '0 0 8px 0', color: '#065f46', fontSize: '16px' }}>
                  ÏòàÏÉÅ Ï¢ÖÌï© Ï†êÏàò
                </h4>
                <p style={{ margin: '0', color: '#166534', fontSize: '14px', lineHeight: '1.5' }}>
                  {previewScore >= 80 ? 'üéâ Ïö∞ÏàòÌïú Î©¥Ï†ë ÏàòÌñâ!' : 
                   previewScore >= 70 ? 'üëç Ï¢ãÏùÄ Î©¥Ï†ë ÌÉúÎèÑÎ•º Î≥¥ÏòÄÏäµÎãàÎã§' : 
                   previewScore >= 60 ? 'üí™ Í∏∞Î≥∏Í∏∞Î•º Í∞ñÏ∂îÍ≥† ÏûàÏäµÎãàÎã§' : 
                   'üìà Îçî ÎßéÏùÄ Ïó∞ÏäµÏù¥ ÌïÑÏöîÌï©ÎãàÎã§'}
                  <br />
                  <small>* ÏµúÏ¢Ö AI Î∂ÑÏÑùÏóêÏÑú Îçî Ï†ïÌôïÌïú Í≤∞Í≥ºÎ•º ÌôïÏù∏ÌïòÏÑ∏Ïöî</small>
                </p>
              </div>
            </div>
            
            {/* Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑù ÏÉÅÏÑ∏ ÏßÄÌëú */}
            <div style={{ 
              display: 'grid', 
              gridTemplateColumns: 'repeat(auto-fit, minmax(200px, 1fr))', 
              gap: '16px',
              marginBottom: '20px'
            }}>
              {/* ÏùåÏÑ± Î∂ÑÏÑù ÎØ∏Î¶¨Î≥¥Í∏∞ */}
              <div style={{
                padding: '16px',
                backgroundColor: '#fef9c3',
                borderRadius: '8px',
                border: '1px solid #fde047'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
                  <Mic size={20} style={{ color: '#ca8a04' }} />
                  <h5 style={{ margin: 0, color: '#a16207', fontSize: '14px', fontWeight: '600' }}>ÏùåÏÑ± Î∂ÑÏÑù</h5>
                </div>
                <div style={{ fontSize: '12px', color: '#92400e', lineHeight: '1.4' }}>
                  ‚Ä¢ ÌèâÍ∑† Î≥ºÎ•®: {realTimeAnalysisData.audio?.averageVolume || 0}<br />
                  ‚Ä¢ ÎßêÌïòÍ∏∞ ÏãúÍ∞Ñ: {realTimeAnalysisData.audio?.speakingTime || 0}Ï¥à<br />
                  ‚Ä¢ ÎßêÌïòÍ∏∞ ÏÜçÎèÑ: {realTimeAnalysisData.audio?.wordsPerMinute || 0} WPM<br />
                  ‚Ä¢ ÏäµÍ¥ÄÏñ¥: {realTimeAnalysisData.audio?.fillerWordsCount || 0}Ìöå
                </div>
              </div>
              
              {/* ÏòÅÏÉÅ Î∂ÑÏÑù ÎØ∏Î¶¨Î≥¥Í∏∞ */}
              <div style={{
                padding: '16px',
                backgroundColor: '#dbeafe',
                borderRadius: '8px',
                border: '1px solid #93c5fd'
              }}>
                <div style={{ display: 'flex', alignItems: 'center', gap: '8px', marginBottom: '12px' }}>
                  <Eye size={20} style={{ color: '#2563eb' }} />
                  <h5 style={{ margin: 0, color: '#1d4ed8', fontSize: '14px', fontWeight: '600' }}>ÏòÅÏÉÅ Î∂ÑÏÑù</h5>
                </div>
                <div style={{ fontSize: '12px', color: '#1e40af', lineHeight: '1.4' }}>
                  ‚Ä¢ ÏñºÍµ¥ Í∞êÏßÄ: {realTimeAnalysisData.video?.faceDetected ? '‚úì' : '‚úó'}<br />
                  ‚Ä¢ ÏïÑÏù¥Ïª®ÌÉù: {realTimeAnalysisData.video?.eyeContactPercentage || 0}%<br />
                  ‚Ä¢ ÌëúÏ†ï: {realTimeAnalysisData.video?.smileDetection || 0}%<br />
                  ‚Ä¢ ÏûêÏÑ∏: {realTimeAnalysisData.video?.postureScore || 0}Ï†ê
                </div>
              </div>
            </div>
            
            {/* Ï£ºÏöî Ïù∏ÏÇ¨Ïù¥Ìä∏ */}
            <div style={{
              padding: '16px',
              backgroundColor: '#f0f9ff',
              borderRadius: '8px',
              border: '1px solid #bfdbfe'
            }}>
              <h5 style={{ margin: '0 0 8px 0', color: '#1e40af', fontSize: '14px', fontWeight: '600' }}>
                üîç Ï£ºÏöî Ïù∏ÏÇ¨Ïù¥Ìä∏
              </h5>
              <ul style={{ margin: 0, paddingLeft: '16px', color: '#1e40af', fontSize: '12px', lineHeight: '1.5' }}>
                {realTimeAnalysisData.video?.eyeContactPercentage >= 60 && (
                  <li>Ïö∞ÏàòÌïú ÏïÑÏù¥Ïª®ÌÉùÏúºÎ°ú ÏûêÏã†Í∞ê ÏûàÎäî Ïù∏ÏÉÅÏùÑ Ï£ºÏóàÏäµÎãàÎã§</li>
                )}
                {realTimeAnalysisData.audio?.averageVolume >= 20 && realTimeAnalysisData.audio?.averageVolume <= 80 && (
                  <li>Ï†ÅÏ†àÌïú Î™©ÏÜåÎ¶¨ ÌÅ¨Í∏∞Î°ú Î™ÖÌôïÌïòÍ≤å Ï†ÑÎã¨ÌñàÏäµÎãàÎã§</li>
                )}
                {realTimeAnalysisData.video?.smileDetection >= 25 && (
                  <li>Î∞ùÏùÄ ÌëúÏ†ïÏúºÎ°ú Í∏çÏ†ïÏ†ÅÏù∏ Ïù∏ÏÉÅÏùÑ Ï£ºÏóàÏäµÎãàÎã§</li>
                )}
                {realTimeAnalysisData.audio?.fillerWordsCount <= 3 && (
                  <li>ÏäµÍ¥ÄÏñ¥ ÏÇ¨Ïö©ÏùÑ Ïûò ÏûêÏ†úÌïòÏó¨ ÍπîÎÅîÌïú Î∞úÌôîÎ•º Î≥¥ÏòÄÏäµÎãàÎã§</li>
                )}
                {/* Í∞úÏÑ† Ìè¨Ïù∏Ìä∏ */}
                {realTimeAnalysisData.video?.eyeContactPercentage < 40 && (
                  <li style={{ color: '#f59e0b' }}>üí° ÏïÑÏù¥Ïª®ÌÉùÏùÑ Îçî ÏûêÏ£º ÌïòÎ©¥ ÎçîÏö± Ï¢ãÏùÑ Í≤ÉÏûÖÎãàÎã§</li>
                )}
                {realTimeAnalysisData.audio?.averageVolume < 15 && (
                  <li style={{ color: '#f59e0b' }}>üí° Î™©ÏÜåÎ¶¨Î•º Ï°∞Í∏à Îçî ÌÅ¨Í≤å ÌïòÎ©¥ ÎçîÏö± Ï¢ãÏùÑ Í≤ÉÏûÖÎãàÎã§</li>
                )}
              </ul>
            </div>
          </div>
        )}

        {/* AI Î∂ÑÏÑù ÏòµÏÖò (Ïã§ÏãúÍ∞Ñ Î∂ÑÏÑùÏù¥ ÏûàÎäî Í≤ΩÏö∞) */}
        {hasRealTimeAnalysis && onStartAIAnalysis && (
          <div style={{ 
            backgroundColor: 'white', 
            borderRadius: '12px', 
            boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
            padding: '24px',
            marginBottom: '24px',
            border: '2px solid #3b82f6'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px' }}>
              <Brain size={32} style={{ color: '#3b82f6', marginRight: '12px' }} />
              <div>
                <h3 style={{ fontSize: '20px', fontWeight: '700', color: '#1f2937', margin: 0 }}>
                  ü§ñ AI Î©¥Ï†ë Î∂ÑÏÑù Í≤∞Í≥º ÌôïÏù∏
                </h3>
                <p style={{ color: '#6b7280', fontSize: '14px', margin: '4px 0 0 0' }}>
                  Ïã§ÏãúÍ∞ÑÏúºÎ°ú ÏàòÏßëÎêú ÏùåÏÑ±, ÏòÅÏÉÅ Îç∞Ïù¥ÌÑ∞Î•º Î∞îÌÉïÏúºÎ°ú ÏÉÅÏÑ∏Ìïú Î∂ÑÏÑù Î¶¨Ìè¨Ìä∏Î•º Ï†úÍ≥µÌï©ÎãàÎã§
                </p>
              </div>
            </div>
            
            <div style={{ 
              backgroundColor: '#f0f9ff', 
              padding: '16px', 
              borderRadius: '8px', 
              marginBottom: '16px',
              border: '1px solid #bfdbfe'
            }}>
              <h4 style={{ fontSize: '16px', fontWeight: '600', color: '#1e40af', margin: '0 0 8px 0' }}>
                üìä ÏÉÅÏÑ∏ Î∂ÑÏÑù Ìï≠Î™©
              </h4>
              <ul style={{ margin: 0, paddingLeft: '20px', color: '#1e40af' }}>
                <li>üé§ <strong>ÏùåÏÑ± Î∂ÑÏÑù:</strong> Î™©ÏÜåÎ¶¨ ÌÜ§, ÎßêÌïòÍ∏∞ ÏÜçÎèÑ, Î≥ºÎ•®, ÏäµÍ¥ÄÏñ¥ ÏÇ¨Ïö©</li>
                <li>üëÅÔ∏è <strong>ÏòÅÏÉÅ Î∂ÑÏÑù:</strong> ÏïÑÏù¥Ïª®ÌÉù, ÌëúÏ†ï, ÏûêÏÑ∏, ÏñºÍµ¥ Í∞êÏßÄ</li>
                <li>üìù <strong>ÎãµÎ≥Ä Î∂ÑÏÑù:</strong> ÎãµÎ≥Ä ÏôÑÏÑ±ÎèÑ, Ïñ¥Ìúò Îã§ÏñëÏÑ±, ÎãµÎ≥Ä Í∏∏Ïù¥</li>
                <li>üìà <strong>Ï¢ÖÌï© ÌèâÍ∞Ä:</strong> Í∞úÏù∏Î≥Ñ ÎßûÏ∂§ ÌîºÎìúÎ∞± Î∞è Í∞úÏÑ† Î∞©Ìñ•</li>
                <li>üìã <strong>ÏÉÅÏÑ∏ Î¶¨Ìè¨Ìä∏:</strong> Îã§Ïö¥Î°úÎìú Í∞ÄÎä•Ìïú Î∂ÑÏÑù Î≥¥Í≥†ÏÑú</li>
              </ul>
            </div>
            
            <button
              onClick={onStartAIAnalysis}
              style={{
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                padding: '16px 24px',
                backgroundColor: '#3b82f6',
                color: 'white',
                border: 'none',
                borderRadius: '8px',
                cursor: 'pointer',
                fontSize: '16px',
                fontWeight: '600',
                width: '100%',
                justifyContent: 'center',
                transition: 'background-color 0.2s'
              }}
              onMouseOver={(e) => e.target.style.backgroundColor = '#2563eb'}
              onMouseOut={(e) => e.target.style.backgroundColor = '#3b82f6'}
            >
              <Brain size={20} />
              ÏÉÅÏÑ∏ AI Î∂ÑÏÑù Í≤∞Í≥º ÌôïÏù∏ÌïòÍ∏∞
            </button>
          </div>
        )}

        {/* ÎÖπÌôî ÏòÅÏÉÅ Ï†ïÎ≥¥ (ÎÖπÌôîÍ∞Ä ÏûàÎäî Í≤ΩÏö∞) */}
        {hasRecording && (
          <div style={{ 
            backgroundColor: 'white', 
            borderRadius: '12px', 
            boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
            padding: '24px',
            marginBottom: '16px'
          }}>
            <div style={{ display: 'flex', alignItems: 'center', marginBottom: '16px' }}>
              <Play size={24} style={{ color: '#8b5cf6', marginRight: '12px' }} />
              <h3 style={{ fontSize: '18px', fontWeight: '600', color: '#1f2937', margin: 0 }}>
                üìπ Î©¥Ï†ë ÎÖπÌôî ÏòÅÏÉÅ
              </h3>
            </div>
            <div style={{ 
              backgroundColor: '#faf5ff', 
              padding: '16px', 
              borderRadius: '8px',
              border: '1px solid #e9d5ff'
            }}>
              <div style={{ display: 'flex', alignItems: 'center', gap: '16px' }}>
                <Clock size={16} style={{ color: '#8b5cf6' }} />
                <span style={{ color: '#7c3aed', fontWeight: '600' }}>
                  ÎÖπÌôî ÏãúÍ∞Ñ: {formatDuration(recordingDuration)}
                </span>
              </div>
              <p style={{ color: '#6b46c1', fontSize: '14px', margin: '8px 0 0 0' }}>
                üí° AI Î∂ÑÏÑùÏóêÏÑú ÎÖπÌôîÎêú ÏòÅÏÉÅÏùÑ Ìï®Íªò ÌôïÏù∏Ìï† Ïàò ÏûàÏäµÎãàÎã§.
              </p>
            </div>
          </div>
        )}

        {/* ÏßàÎ¨∏Î≥Ñ ÎãµÎ≥Ä Í≤∞Í≥º */}
        {(questions || []).map((question, index) => {
          const answerStats = calculateAnswerStats((answers || [])[index]);
          
          return (
            <div key={index} style={{ 
              backgroundColor: 'white', 
              borderRadius: '12px', 
              boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
              padding: '24px',
              marginBottom: '16px'
            }}>
              {/* ÏßàÎ¨∏ Î≤àÌò∏ */}
              <div style={{ 
                display: 'flex', 
                alignItems: 'center', 
                marginBottom: '16px'
              }}>
                <div style={{ 
                  width: '32px', 
                  height: '32px', 
                  backgroundColor: '#3b82f6', 
                  borderRadius: '50%', 
                  display: 'flex', 
                  alignItems: 'center', 
                  justifyContent: 'center',
                  marginRight: '12px'
                }}>
                  <span style={{ 
                    color: 'white', 
                    fontWeight: '600', 
                    fontSize: '14px' 
                  }}>
                    {index + 1}
                  </span>
                </div>
                <h3 style={{ 
                  fontSize: '18px', 
                  fontWeight: '600', 
                  color: '#1f2937', 
                  margin: 0 
                }}>
                  ÏßàÎ¨∏ {index + 1}
                </h3>
              </div>
              
              {/* ÏßàÎ¨∏ ÎÇ¥Ïö© */}
              <div style={{ 
                backgroundColor: '#dbeafe', 
                borderRadius: '8px', 
                padding: '16px',
                marginBottom: '16px'
              }}>
                <p style={{ 
                  color: '#1e40af', 
                  fontSize: '16px', 
                  fontWeight: '500', 
                  margin: 0 
                }}>
                  Q. {question}
                </p>
              </div>
              
              {/* ÎãµÎ≥Ä ÎÇ¥Ïö© */}
              <div style={{ 
                backgroundColor: '#f0fdf4', 
                borderRadius: '8px', 
                padding: '16px',
                border: '1px solid #bbf7d0'
              }}>
                <div style={{ 
                  display: 'flex', 
                  alignItems: 'center', 
                  marginBottom: '8px'
                }}>
                  <FileText size={16} style={{ color: '#059669', marginRight: '8px' }} />
                  <span style={{ 
                    fontSize: '14px', 
                    fontWeight: '600', 
                    color: '#059669' 
                  }}>
                    ÏùåÏÑ± Ïù∏Ïãù Í≤∞Í≥º
                  </span>
                </div>
                <p style={{ 
                  color: '#064e3b', 
                  fontSize: '15px', 
                  lineHeight: '1.6', 
                  margin: '0 0 12px 0',
                  whiteSpace: 'pre-wrap'
                }}>
                  {(answers || [])[index] || 'ÎãµÎ≥ÄÏù¥ Í∏∞Î°ùÎêòÏßÄ ÏïäÏïòÏäµÎãàÎã§.'}
                </p>
                
                {/* ÎãµÎ≥Ä ÌÜµÍ≥Ñ */}
                <div style={{ 
                  fontSize: '12px', 
                  color: '#6b7280', 
                  paddingTop: '12px',
                  borderTop: '1px solid #e5e7eb',
                  display: 'grid',
                  gridTemplateColumns: 'repeat(auto-fit, minmax(100px, 1fr))',
                  gap: '8px'
                }}>
                  <div>üìä ÎãµÎ≥Ä Í∏∏Ïù¥: <strong>{answerStats.length}Ïûê</strong></div>
                  <div>üìù Îã®Ïñ¥ Ïàò: <strong>{answerStats.wordCount}Í∞ú</strong></div>
                  <div>üïê ÏòàÏÉÅ ÏãúÍ∞Ñ: <strong>{answerStats.estimatedTime}Î∂Ñ</strong></div>
                  <div>üìà ÏôÑÏÑ±ÎèÑ: <strong>{(answers || [])[index] ? 'ÏôÑÎ£å' : 'ÎØ∏ÏôÑÎ£å'}</strong></div>
                </div>
              </div>
            </div>
          );
        })}

        {/* Ïï°ÏÖò Î≤ÑÌäº */}
        <div style={{ 
          backgroundColor: 'white', 
          borderRadius: '12px', 
          boxShadow: '0 10px 15px -3px rgba(0,0,0,0.1)', 
          padding: '24px',
          display: 'flex',
          gap: '12px',
          justifyContent: 'center',
          flexWrap: 'wrap'
        }}>
          <button
            onClick={onRestart}
            style={{
              display: 'flex',
              alignItems: 'center',
              gap: '8px',
              padding: '12px 24px',
              backgroundColor: '#3b82f6',
              color: 'white',
              border: 'none',
              borderRadius: '8px',
              cursor: 'pointer',
              fontSize: '16px',
              fontWeight: '600',
              transition: 'background-color 0.2s',
              minWidth: '160px',
              justifyContent: 'center'
            }}
            onMouseOver={(e) => e.target.style.backgroundColor = '#2563eb'}
            onMouseOut={(e) => e.target.style.backgroundColor = '#3b82f6'}
          >
            üîÑ Îã§Ïãú Î©¥Ï†ë Î≥¥Í∏∞
          </button>

          {/* üéØ Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞ Î≤ÑÌäº Ï∂îÍ∞Ä (Í∞úÎ∞ú Î™®ÎìúÏóêÏÑúÎßå) */}
          {process.env.NODE_ENV === 'development' && (
            <button
              onClick={openDeveloperDataWindow}
              style={{
                display: 'flex',
                alignItems: 'center',
                gap: '8px',
                padding: '12px 24px',
                backgroundColor: '#ef4444',
                color: 'white',
                border: 'none',
                borderRadius: '8px',
                cursor: 'pointer',
                fontSize: '16px',
                fontWeight: '600',
                transition: 'background-color 0.2s',
                minWidth: '160px',
                justifyContent: 'center'
              }}
              onMouseOver={(e) => e.target.style.backgroundColor = '#dc2626'}
              onMouseOut={(e) => e.target.style.backgroundColor = '#ef4444'}
            >
              <Database size={16} />
              üî¨ Í∞úÎ∞úÏûê Îç∞Ïù¥ÌÑ∞
            </button>
          )}
          
          <button
            onClick={onClose}
            style={{
              display: 'flex',
              alignItems: 'center',
              gap: '8px',
              padding: '12px 24px',
              backgroundColor: '#6b7280',
              color: 'white',
              border: 'none',
              borderRadius: '8px',
              cursor: 'pointer',
              fontSize: '16px',
              fontWeight: '600',
              transition: 'background-color 0.2s',
              minWidth: '160px',
              justifyContent: 'center'
            }}
            onMouseOver={(e) => e.target.style.backgroundColor = '#4b5563'}
            onMouseOut={(e) => e.target.style.backgroundColor = '#6b7280'}
          >
            <X size={16} />
            Î©¥Ï†ë Ï¢ÖÎ£å
          </button>
        </div>

        {/* Í∞úÎ∞úÏûê Ï†ïÎ≥¥ */}
        <div style={{ 
          textAlign: 'center', 
          marginTop: '24px', 
          padding: '16px',
          backgroundColor: 'white',
          borderRadius: '8px',
          fontSize: '12px',
          color: '#9ca3af'
        }}>
          <p style={{ margin: 0 }}>
            üí° <strong>Í∞úÏù∏Ï†ïÎ≥¥ Î≥¥Ìò∏:</strong> Î™®Îì† ÏùåÏÑ± Ïù∏Ïãù Î∞è Î∂ÑÏÑùÏùÄ Î∏åÎùºÏö∞Ï†ÄÏóêÏÑú Ï≤òÎ¶¨ÎêòÏñ¥ Ïô∏Î∂ÄÎ°ú Ï†ÑÏÜ°ÎêòÏßÄ ÏïäÏäµÎãàÎã§.
          </p>
        </div>
      </div>
    </div>
  );
};

export default InterviewResult;